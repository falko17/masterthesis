%! TEX root = ../thesis.tex
\usepackage[toc,numberedsection=autolabel,section=chapter,abbreviations,xindy]{glossaries-extra}
%\usepackage{glossary-mcols}
%\usepackage{marginnote}
\usepackage{glossary-longextra}
\usepackage{marginfix}
\usepackage{float}

% This part is from https://tex.stackexchange.com/a/605352
\makeatletter
\newfloat{info@box}{tbp}{loi}[section]% 1: Name of float environment. 2: Default placement (top, bottom, ...). 3: File extension if written to an aux-file (like toc, lof, lot, loa, ...). 4: Numbering within <section/subsection/...>.
\makeatother
\floatname{info@box}{Infobox}% Adapt caption.

\newenvironment{infobox}[1]{% Create new environment using info@box and tcolorbox
	\begin{info@box}
		\begin{tcolorbox}[colback=Maroon!15!white,colframe=Maroon!75!black,
				arc=0mm, width=\textwidth, %left=1mm, right=1mm,
				boxrule=0.2mm, boxsep=0.3mm,
				toptitle=0.5mm, bottomtitle=0.2mm, lefttitle=1mm, righttitle=1mm,
				beforeafter skip=-2mm,
				fonttitle=\bfseries\sffamily\small,
				enhanced, drop fuzzy shadow,
				adjusted title=New Term: #1
			]%
			}{%
		\end{tcolorbox}
	\end{info@box}
}

\DeclareNewFootnote{G}
\renewcommand*{\thefootnoteG}{\firstuseformat{\fnsymbol{footnoteG}}}

% No links for description
\let\oldglsdesc\glsdesc
\renewcommand{\glsdesc}[1]{\oldglsdesc*{#1}}
\let\Oldglsdesc\Glsdesc
\renewcommand{\Glsdesc}[1]{\Oldglsdesc*{#1}}

% File index
\newglossary{file}{fln}{flo}{Attached Files}
\makeglossaries{}

% FIXME  Acronyms' long form not shown at the end.

% ----------------------------------------------------------------------------

% https://tex.stackexchange.com/a/359561

\let\fc\lowercase
\let\oldprintglossary\printglossary
\def\printglossary{\let\fc\uppercase\oldprintglossary}

% Full name on first time
\setabbreviationstyle[acronym]{long-postshort-user}
% Also color acronym itself (or not)
% \renewcommand{\glsfirstabbrvuserfont}[1]{\textcolor{Maroon}{#1}}

\newcommand{\glossterm}[1]{%
	\ifglshaslong{#1}%
	{\textit{\glsentrytext{#1}} (\glsxtrlong{#1})}%
	{\textit{\glsentrytext{#1}}}%
}

% Only color for the first time
\newcommand{\firstuseformat}[1]{\textcolor{Maroon}{{#1}}}
\newcommand{\seconduseformat}[1]{\textcolor{black}{{#1}}}
\newcommand{\mainformat}[1]{%
	\ifglsused{#1}{}{\glslinkvar{%
			\let\fc\uppercase%
			% \begin{infobox}{\glossterm{#1}}
			% 	\glsentrydesc{#1}
			% \end{infobox}%
			\footnoteG{\firstuseformat{\Glsentrytext{#1}}: \glsentrydesc{#1}}%
			\let\fc\lowercase}{}{}%
	}%
}


\defglsentryfmt[main]{\glsgenentryfmt\mainformat{\glslabel}}
%\defglsentryfmt[\acronymtype]{\glsgenentryfmt\ifglsused{\glslabel}{\glsentryshort{\glslabel}}{\glsentrylong{\glslabel}}\mainformat{\glslabel}}
\defglsentryfmt[\acronymtype]{\glsgenentryfmt\ifglsused{\glslabel}{}{\mainformat{\glslabel}}}

% Remove emphasis and set new color for files
\defglsentryfmt[file]{\emph{\textcolor{Cyan}{\glsentryname{\glslabel}}}}

\renewcommand{\glslinkpresetkeys}{%
	\ifglsused{\glslabel}%
	{\let\glstextformat\seconduseformat}%
	{\let\glstextformat\firstuseformat}%
}

% Special margin note for symbols
\newcommand{\glsmarginpar}[1]{
	\let\fc\uppercase%
	\marginpar{%
		\textcolor{Maroon}{\emph{\glsentryname{#1} (\glsentrysymbol{#1})}:} \glsentrydesc{#1}}%
	\let\fc\lowercase%
}


%%% ACRONYMS HERE %%%

\newacronym[description={\fc{A} protocol that can be viewed as the analogue to LSP for debuggers, with the goal to make it easier to integrate debuggers into development tools.}]{dap}{DAP}{Debug Adapter Protocol}

\newacronym[description={\fc{A} file format in which tabular data is stored as comma-separated columns.}]{csv}{CSV}{Comma-Separated Values}

\newacronym[description={A syntax in which context-free grammars can be formally expressed.}]{ebnf}{EBNF}{Extended Backusâ€“Naur Form}

\newacronym[description={\fc{A} file format for graphs, used in \gls{see} for representing dependency and hierarchy graphs of software projects.}]{gxl}{GXL}{Graph eXchange Language}

\newacronym[description={\fc{E}ditor for source code with features that are useful for development (\eg, highlighting errors). Examples are \emph{Eclipse} or \emph{\textsc{JetBrains} IntelliJ}}.]{ide}{IDE}{Integrated Development Environment}

\newacronym[description={\fc{A} remote procedure call protocol that uses JSON as its encoding, supporting (among other features) asynchronous calls and notifications. It is used as the base for \gls{lsp} (even though \gls{lsp} is technically not a remote protocol).}]{jrpc}{JSON-RPC}{JavaScript Object Notation---Remote Procedure Call}

\newacronym[description={\fc{T}he number of lines in a source code file.}]{loc}{LOC}{Lines of Code}

\newacronym[description={\fc{A} format which language servers can emit to persist LSP-based information about a software project.}]{lsif}{LSIF}{Language Server Index Format}

\newacronym[description={\fc{A} protocol which specifies how language servers can provide language-specific features to IDEs, such as hover information, go to definition, or diagnostics.}]{lsp}{LSP}{Language Server Protocol}

\newacronym[description={\fc{A}n interactive software visualization tool using the code city metaphor in 3D, developed in the Unity game engine at the University of Bremen.}]{see}{SEE}{Software Engineering Experience}

\newacronym[description={A simple questionnaire by \textcite{brooke1996} with ten Likert-scale questions that are supposed to measure the usability of a system.}]{sus}{SUS}{System Usability Scale}

\newacronym{ui}{UI}{User Interface}

\newacronym[description={A string that uniquely identifies some resource.}]{uri}{URI}{Uniform Resource Identifier}

\newacronym[description={A proprietary, but free \gls{ide} developed by Microsoft with a plugin system from which LSP originated. See \web{https://code.visualstudio.com}{2024-10-05}}]{vscode}{VSCode}{Visual Studio Code}


%%% GLOSSARY HERE %%%

\newglossaryentry{city}{name={c}ode \fc{c}ity,
	description={\fc{I}n the code city metaphor, software components are visualized as buildings within a city, where various metrics of the software are represented visually (\eg, the height of a building could represent the lines of code of the component).},
	plural=code cities}

\newglossaryentry{ls}{name={L}anguage {S}erver,
description={\fc{A} locally-running JSON-RPC-based application following the Language Server Protocol that provides language-specific features and aids to the Language Client.}}

\newglossaryentry{lc}{name={L}anguage {C}lient,
description={\fc{A} development tool, such as an \gls{ide}, that supports \gls{lsp} and can hence integrate language-specific features into itself using compatible \glspl{ls}.}}

\newglossaryentry{capability}{name=\fc{c}apability,
	description={\fc{A} specific set of features a given \gls{ls} (and \gls{lc}) support.},
	plural=capabilities}

\newglossaryentry{window}{name=\fc{c}ode {w}indow, text=code window,
description={\fc{A} source code viewer in \SEE{} which supports very basic \gls{ide}-like functionality.}}

\newglossaryentry{kdtree}{name={$k$-d tree},
	description={\fc{A} data structure (using a binary tree as a basis) with which certain spatial data in $k$ dimensions can be efficiently stored and retrieved.}}

\newglossaryentry{intervaltree}{name=interval tree,
	description={\fc{A} data structure meant to store intervals/ranges in such a way that overlapping or contained intervals can be found efficiently.}}

\newglossaryentry{reflexion}{name=\fc{r}eflexion \fc{a}nalysis,
	description={\fc{T}he process of comparing the architecture and implementation of a software project and finding incongruencies between the two.}}

\newglossaryentry{polytree}{name=\fc{p}olytree,
	description={\fc{A} directed acylic graph which also has no undirected cycles.}}

\newglossaryentry{editor}{name={U}nity Editor,
	description={\fc{T}he main \gls{ui} of the Unity game engine, in which scenes can be set up, components can be configured, the game itself can be run, etc. Note that it is only used for development purposes, and hence not included within generated builds of a game.}}

\newglossaryentry{provider}{name=\fc{G}raph provider,
	description={\fc{A} component in \SEE{} that produces or transforms a project graph by some means. Can optionally take configuration parameters by users.}}

\newglossaryentry{smell}{name=\fc{c}ode \fc{s}mell,
	description={\fc{c}ertain structures in source code that suggest that a refactoring is in order, such as duplicated code, or a very long method~\cite[85-87]{fowler2019}.}}

\newglossaryentry{range}{name=Source Range, text=range,
	description={\fc{t}he contiguous portion within a source code file that a certain element occupies. In this thesis, we will express it as an ordered pair of a start and end position $(s, e)$, or, alternatively, as a 4-tuple $(s_l, s_c, e_l, e_c)$.
			In the latter representation, the first two elements describe the zero-indexed start line and start character offset, respectively, and the last two describe the corresponding (exclusive) end line and end character offset.}}

\newglossaryentry{token}{name=\fc{s}emantic token, text=semantic token,
	description={An \gls{lsp} \gls{capability} that returns tokens for a document, with the intention that those tokens can be used to apply syntax highlighting to the file. Apart from token types, it also offers token \emph{modifiers}, which can be used to apply additional formatting on top of the colors from the types.}}

%%% DIGITAL HERE %%%
\newglossaryentry{seezip}{name={\tt{SEE.zip}}, type=file,
	description={\fc{T}he build of \SEE{} used for the evaluation.}}
